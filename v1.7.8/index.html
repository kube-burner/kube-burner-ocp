
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="media/logo/kube-burner-logo-mini.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Kube-burner-ocp</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#openshift-wrapper" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Kube-burner-ocp" class="md-header__button md-logo" aria-label="Kube-burner-ocp" data-md-component="logo">
      
  <img src="media/logo/kube-burner-logo-mini.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kube-burner-ocp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OpenShift
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label=""  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/kube-burner/kube-burner-ocp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Kube-burner-ocp" class="md-nav__button md-logo" aria-label="Kube-burner-ocp" data-md-component="logo">
      
  <img src="media/logo/kube-burner-logo-mini.png" alt="logo">

    </a>
    Kube-burner-ocp
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kube-burner/kube-burner-ocp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    OpenShift
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    OpenShift
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-endpoints-support" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple endpoints support
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multiple endpoints support">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metrics-endpointsyaml" class="md-nav__link">
    <span class="md-ellipsis">
      metrics-endpoints.yaml
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-density-workloads" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster density workloads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cluster density workloads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-density-v2" class="md-nav__link">
    <span class="md-ellipsis">
      cluster-density-v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-density-ms" class="md-nav__link">
    <span class="md-ellipsis">
      cluster-density-ms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-density-workloads" class="md-nav__link">
    <span class="md-ellipsis">
      Node density workloads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Node density workloads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#node-density" class="md-nav__link">
    <span class="md-ellipsis">
      node-density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-density-cni" class="md-nav__link">
    <span class="md-ellipsis">
      node-density-cni
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-density-heavy" class="md-nav__link">
    <span class="md-ellipsis">
      node-density-heavy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-scale" class="md-nav__link">
    <span class="md-ellipsis">
      node-scale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#udn-density-l3-pods" class="md-nav__link">
    <span class="md-ellipsis">
      udn-density-l3-pods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anp-density-pods" class="md-nav__link">
    <span class="md-ellipsis">
      anp-density-pods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-policy-workloads" class="md-nav__link">
    <span class="md-ellipsis">
      Network Policy workloads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Network Policy workloads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scale-testing-and-unique-acl-flows" class="md-nav__link">
    <span class="md-ellipsis">
      Scale Testing and Unique ACL Flows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#egressip-workloads" class="md-nav__link">
    <span class="md-ellipsis">
      EgressIP workloads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-burner-workloads" class="md-nav__link">
    <span class="md-ellipsis">
      Web-burner workloads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web-burner workloads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#web-burner-init" class="md-nav__link">
    <span class="md-ellipsis">
      web-burner-init
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-burner-node-density" class="md-nav__link">
    <span class="md-ellipsis">
      web-burner-node-density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-burner-cluster-density" class="md-nav__link">
    <span class="md-ellipsis">
      web-burner-cluster-density
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-rds-workloads" class="md-nav__link">
    <span class="md-ellipsis">
      Core RDS workloads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#virt-workloads" class="md-nav__link">
    <span class="md-ellipsis">
      Virt Workloads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Virt Workloads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#virtctl" class="md-nav__link">
    <span class="md-ellipsis">
      Virtctl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temporary-ssh-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Temporary SSH Keys
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virt-density" class="md-nav__link">
    <span class="md-ellipsis">
      Virt Density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virt-density-udn" class="md-nav__link">
    <span class="md-ellipsis">
      Virt Density Udn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virt-capacity-benchmark" class="md-nav__link">
    <span class="md-ellipsis">
      Virt Capacity Benchmark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Virt Capacity Benchmark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      Test Sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tested-storageclass" class="md-nav__link">
    <span class="md-ellipsis">
      Tested StorageClass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-namespace" class="md-nav__link">
    <span class="md-ellipsis">
      Test Namespace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-size-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Test Size Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skip-test-parts" class="md-nav__link">
    <span class="md-ellipsis">
      Skip test parts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virt-clone" class="md-nav__link">
    <span class="md-ellipsis">
      Virt Clone
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Virt Clone">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-sequence_1" class="md-nav__link">
    <span class="md-ellipsis">
      Test Sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tested-storageclass_1" class="md-nav__link">
    <span class="md-ellipsis">
      Tested StorageClass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-namespace_1" class="md-nav__link">
    <span class="md-ellipsis">
      Test Namespace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-size-parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      Test Size Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-of-cloned-virtualmachines-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Verification of cloned VirtualMachines creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volume-access-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Volume Access Mode
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virt-ephemeral-restart" class="md-nav__link">
    <span class="md-ellipsis">
      Virt Ephemeral Restart
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Virt Ephemeral Restart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-sequence_2" class="md-nav__link">
    <span class="md-ellipsis">
      Test Sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tested-storageclass_2" class="md-nav__link">
    <span class="md-ellipsis">
      Tested StorageClass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-namespace_2" class="md-nav__link">
    <span class="md-ellipsis">
      Test Namespace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-size-parameters_2" class="md-nav__link">
    <span class="md-ellipsis">
      Test Size Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volume-access-mode_1" class="md-nav__link">
    <span class="md-ellipsis">
      Volume Access Mode
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virt-migration" class="md-nav__link">
    <span class="md-ellipsis">
      Virt Migration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Virt Migration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-sequence_3" class="md-nav__link">
    <span class="md-ellipsis">
      Test Sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tested-storageclass_3" class="md-nav__link">
    <span class="md-ellipsis">
      Tested StorageClass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-size-parameters_3" class="md-nav__link">
    <span class="md-ellipsis">
      Test Size Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addition-virtualmachines-load" class="md-nav__link">
    <span class="md-ellipsis">
      Addition VirtualMachines load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limiting-migration-requests-load" class="md-nav__link">
    <span class="md-ellipsis">
      Limiting migration requests load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-worker-node" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Worker Node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-namespace_3" class="md-nav__link">
    <span class="md-ellipsis">
      Test Namespace
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datavolume-clone" class="md-nav__link">
    <span class="md-ellipsis">
      DataVolume Clone
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DataVolume Clone">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-sequence_4" class="md-nav__link">
    <span class="md-ellipsis">
      Test Sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tested-storageclass_4" class="md-nav__link">
    <span class="md-ellipsis">
      Tested StorageClass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-namespace_4" class="md-nav__link">
    <span class="md-ellipsis">
      Test Namespace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-container-disk-image" class="md-nav__link">
    <span class="md-ellipsis">
      Test Container Disk Image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-size-parameters_4" class="md-nav__link">
    <span class="md-ellipsis">
      Test Size Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volume-access-mode_2" class="md-nav__link">
    <span class="md-ellipsis">
      Volume Access Mode
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cudn-bgp-workload" class="md-nav__link">
    <span class="md-ellipsis">
      CUDN BGP Workload
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CUDN BGP Workload">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#routeadvertisement-latency-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      RouteAdvertisement Latency Metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olmv1-benchmark" class="md-nav__link">
    <span class="md-ellipsis">
      OLMv1 Benchmark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OLMv1 Benchmark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-requirements_1" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kueue-operator-workloads" class="md-nav__link">
    <span class="md-ellipsis">
      Kueue Operator workloads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kueue Operator workloads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kueue-operator-jobs" class="md-nav__link">
    <span class="md-ellipsis">
      kueue-operator-jobs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kueue-operator-jobs-shared" class="md-nav__link">
    <span class="md-ellipsis">
      kueue-operator-jobs-shared
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kueue-operator-pods" class="md-nav__link">
    <span class="md-ellipsis">
      kueue-operator-pods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-workload-bring-your-own-workload" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Workload: Bring your own workload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      Index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics-profile-type" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics-profile type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customizing-workloads" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing workloads
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="openshift-wrapper">OpenShift Wrapper<a class="headerlink" href="#openshift-wrapper" title="Permanent link">&para;</a></h1>
<p><a href="https://opensource.org/licenses/Apache-2.0"><img alt="License" src="https://img.shields.io/badge/License-Apache%202.0-blue.svg" /></a>
<a href="https://www.bestpractices.dev/projects/10060"><img alt="OpenSSF Best Practices" src="https://www.bestpractices.dev/projects/10060/badge" /></a></p>
<p>This plugin is a very opinionated OpenShift wrapper designed to simplify the execution of different workloads in this Kubernetes distribution.</p>
<p>Executed with <code>kube-burner-ocp</code>, it looks like:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>kube-burner-ocp<span class="w"> </span>--help
<span class="go">kube-burner plugin designed to be used with OpenShift clusters as a quick way to run well-known workloads</span>

<span class="go">Usage:</span>
<span class="go">  kube-burner-ocp [command]</span>

<span class="go">Available Commands:</span>
<span class="go">  cluster-density-ms         Runs cluster-density-ms workload</span>
<span class="go">  cluster-density-v2         Runs cluster-density-v2 workload</span>
<span class="go">  cluster-health             Checks for ocp cluster health</span>
<span class="go">  completion                 Generate the autocompletion script for the specified shell</span>
<span class="go">  crd-scale                  Runs crd-scale workload</span>
<span class="go">  dv-clone                   Runs dv-clone workload</span>
<span class="go">  egressip                   Runs egressip workload</span>
<span class="go">  help                       Help about any command</span>
<span class="go">  index                      Runs index sub-command</span>
<span class="go">  init                       Runs custom workload</span>
<span class="go">  kueue-operator-pods        Runs kueue-operator-pods workload</span>
<span class="go">  kueue-operator-jobs        Runs kueue-operator-jobs workload</span>
<span class="go">  kueue-operator-jobs-shared Runs kueue-operator-jobs-shared workload</span>
<span class="go">  network-policy             Runs network-policy workload</span>
<span class="go">  node-density               Runs node-density workload</span>
<span class="go">  node-density-cni           Runs node-density-cni workload</span>
<span class="go">  node-density-heavy         Runs node-density-heavy workload</span>
<span class="go">  node-scale                 Runs node-scale workload</span>
<span class="go">  olm                        Runs olm workload</span>
<span class="go">  pvc-density                Runs pvc-density workload</span>
<span class="go">  rds-core                   Runs rds-core workload</span>
<span class="go">  udn-bgp                    Runs udn-bgp workload</span>
<span class="go">  udn-density-pods           Runs node-density-udn workload</span>
<span class="go">  version                    Print the version number of kube-burner</span>
<span class="go">  virt-capacity-benchmark    Runs capacity-benchmark workload</span>
<span class="go">  virt-clone                 Runs virt-clone workload</span>
<span class="go">  virt-density               Runs virt-density workload</span>
<span class="go">  virt-ephemeral-restart     Runs virt-ephemeral-restart workload</span>
<span class="go">  virt-migration             Runs virt-migration workload</span>
<span class="go">  virt-udn-density           Runs virt-density-udn workload</span>
<span class="go">  web-burner-cluster-density Runs web-burner-cluster-density workload</span>
<span class="go">  web-burner-init            Runs web-burner-init workload</span>
<span class="go">  web-burner-node-density    Runs web-burner-node-density workload</span>
<span class="go">  whereabouts                Runs whereabouts workload</span>
<span class="go">  anp-density-pods               Runs anp-density-pods workload</span>
<span class="go">  cluster-density-ms             Runs cluster-density-ms workload</span>
<span class="go">  cluster-density-v2             Runs cluster-density-v2 workload</span>
<span class="go">  cluster-health                 Checks for ocp cluster health</span>
<span class="go">  completion                     Generate the autocompletion script for the specified shell</span>
<span class="go">  crd-scale                      Runs crd-scale workload</span>
<span class="go">  help                           Help about any command</span>
<span class="go">  index                          Runs index sub-command</span>
<span class="go">  init                           Runs custom workload</span>
<span class="go">  networkpolicy-matchexpressions Runs networkpolicy-matchexpressions workload</span>
<span class="go">  networkpolicy-matchlabels      Runs networkpolicy-matchlabels workload</span>
<span class="go">  networkpolicy-multitenant      Runs networkpolicy-multitenant workload</span>
<span class="go">  node-density                   Runs node-density workload</span>
<span class="go">  node-density-cni               Runs node-density-cni workload</span>
<span class="go">  node-density-heavy             Runs node-density-heavy workload</span>
<span class="go">  pvc-density                    Runs pvc-density workload</span>
<span class="go">  udn-density-l3-pods            Runs udn-density-l3-pods workload</span>
<span class="go">  version                        Print the version number of kube-burner</span>
<span class="go">  virt-capacity-benchmark        Runs capacity-benchmark workload</span>
<span class="go">  virt-density                   Runs virt-density workload</span>
<span class="go">  web-burner-cluster-density     Runs web-burner-cluster-density workload</span>
<span class="go">  web-burner-init                Runs web-burner-init workload</span>
<span class="go">  web-burner-node-density        Runs web-burner-node-density workload</span>

<span class="go">Flags:</span>
<span class="go">      --alerting                  Enable alerting (default true)</span>
<span class="go">      --burst int                 Burst (default 20)</span>
<span class="go">      --check-health              Check cluster health before job (default true)</span>
<span class="go">      --enable-file-logging       Enable file logging (default true)</span>
<span class="go">      --es-index string           Elastic Search index</span>
<span class="go">      --es-server string          Elastic Search endpoint</span>
<span class="go">      --extract                   Extract workload in the current directory</span>
<span class="go">      --gc                        Garbage collect created resources (default true)</span>
<span class="go">      --gc-metrics                Collect metrics during garbage collection</span>
<span class="go">  -h, --help                      help for kube-burner-ocp</span>
<span class="go">      --local-indexing            Enable local indexing</span>
<span class="go">      --log-level string          Allowed values: debug, info, warn, error, fatal (default &quot;info&quot;)</span>
<span class="go">      --metrics-endpoint string   YAML file with a list of metric endpoints, overrides the es-server and es-index flags</span>
<span class="go">      --profile-type string       Metrics profile to use, supported options are: regular, reporting or both (default &quot;both&quot;)</span>
<span class="go">      --qps int                   QPS (default 20)</span>
<span class="go">      --timeout duration          Benchmark timeout (default 4h0m0s)</span>
<span class="go">      --user-metadata string      User provided metadata file, in YAML format</span>
<span class="go">      --uuid string               Benchmark UUID (default &quot;e5d2e34e-724d-4ba9-9eac-0379839d2e0a&quot;)</span>
</code></pre></div>
<h2 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h2>
<p>Documentation is <a href="https://kube-burner.github.io/kube-burner-ocp/">available here</a></p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>Some of the benefits the OCP wrapper provides are:</p>
<ul>
<li>Simplified execution of the supported workloads. (Only some flags are required)</li>
<li>Adds OpenShift metadata to generated jobSummary and a small subset of metadata fields to the remaining metrics.</li>
<li>Prevents modifying configuration files to tweak some of the parameters of the workloads.</li>
<li>Discovers the Prometheus URL and authentication token, so the user does not have to perform those operations before using them.</li>
<li>Workloads configuration is directly embedded in the binary.</li>
</ul>
<p>Running node-density with 100 pods per node</p>
<div class="highlight"><pre><span></span><code><span class="go">kube-burner-ocp node-density --pods-per-node=100</span>
</code></pre></div>
<p>With the command above, the wrapper will calculate the required number of pods to deploy across all worker nodes of the cluster.</p>
<h2 id="multiple-endpoints-support">Multiple endpoints support<a class="headerlink" href="#multiple-endpoints-support" title="Permanent link">&para;</a></h2>
<p>The flag <code>--metrics-endpoint</code> can be used to interact with multiple Prometheus endpoints
For example:</p>
<div class="highlight"><pre><span></span><code><span class="go">kube-burner-ocp cluster-density-v2 --iterations=1 --churn-duration=2m0s --churn-cycles=2 --es-index kube-burner --es-server https://www.esurl.com:443 --metrics-endpoint metrics-endpoints.yaml</span>
</code></pre></div>
<h3 id="metrics-endpointsyaml">metrics-endpoints.yaml<a class="headerlink" href="#metrics-endpointsyaml" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prometheus-k8s-openshift-monitoring.apps.rook.devshift.org</span>
<span class="w">  </span><span class="nt">metrics</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metrics.yml</span>
<span class="w">  </span><span class="nt">alerts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alerts.yml</span>
<span class="w">  </span><span class="nt">indexer</span><span class="p">:</span>
<span class="w">      </span><span class="nt">esServers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;{{.ES_SERVER}}&quot;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">insecureSkipVerify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">defaultIndex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="nv">.ES_INDEX</span><span class="p p-Indicator">}}</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">opensearch</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://prometheus-k8s-openshift-monitoring.apps.rook.devshift.org</span>
<span class="w">  </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="w"> </span><span class="nv">.TOKEN</span><span class="w"> </span><span class="p p-Indicator">}}</span>
<span class="w">  </span><span class="nt">metrics</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metrics.yml</span>
<span class="w">  </span><span class="nt">indexer</span><span class="p">:</span>
<span class="w">      </span><span class="nt">esServers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;{{.ES_SERVER}}&quot;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">insecureSkipVerify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">defaultIndex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="nv">.ES_INDEX</span><span class="p p-Indicator">}}</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">opensearch</span>
</code></pre></div>
<p><code>.TOKEN</code> can be captured by running <code>TOKEN=$(oc create token -n openshift-monitoring prometheus-k8s)</code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Avoid passing absolute path of the file with --metrics-endpoint option</p>
<p>Metric profile names specified against <code>metrics</code> key should be unique and shouldn't overlap with the existing ones. A metric profile will be looked up in this directory <a href="https://github.com/kube-burner/kube-burner-ocp/tree/main/cmd/config">config</a> first for the sake of simplicity and if it doesn't exist, will fallback to our specified path. So in order for our own metric profile to get picked up, we will need to specify its absolute path or name differently whenever there is an overlap with the existing ones.</p>
</div>
<h2 id="cluster-density-workloads">Cluster density workloads<a class="headerlink" href="#cluster-density-workloads" title="Permanent link">&para;</a></h2>
<p>This workload family is a control-plane density focused workload that that creates different objects across the cluster. There are 2 different variants <a href="#cluster-density-v2">cluster-density-v2</a> and <a href="#cluster-density-ms">cluster-density-ms</a>.</p>
<p>Each iteration of these create a new namespace, the three support similar configuration flags. Check them out from the subcommand help.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Workload churning of 1h is enabled by default in the <code>cluster-density</code> workloads; you can disable it by passing <code>--churn=false</code> to the workload subcommand.</p>
</div>
<h3 id="cluster-density-v2">cluster-density-v2<a class="headerlink" href="#cluster-density-v2" title="Permanent link">&para;</a></h3>
<p>Each iteration creates the following objects in each of the created namespaces:</p>
<ul>
<li>1 image stream.</li>
<li>1 build. The OCP internal container registry must be set-up previously because the resulting container image will be pushed there.</li>
<li>3 deployments with two pod 2 replicas (nginx) mounting 4 secrets, 4 config maps, and 1 downward API volume each.</li>
<li>2 deployments with two pod 2 replicas (curl) mounting 4 Secrets, 4 config maps and 1 downward API volume each. These pods have configured a readiness probe that makes a request to one of the services and one of the routes created by this workload every 10 seconds.</li>
<li>5 services, each one pointing to the TCP/8080 port of one of the nginx deployments.</li>
<li>2 edge routes pointing to the to first and second services respectively.</li>
<li>10 secrets containing a 2048-character random string.</li>
<li>10 config maps containing a 2048-character random string.</li>
<li>3 network policies:<ul>
<li>deny-all traffic</li>
<li>allow traffic from client/nginx pods to server/nginx pods</li>
<li>allow traffic from openshift-ingress namespace (where routers are deployed by default) to the namespace</li>
</ul>
</li>
</ul>
<h3 id="cluster-density-ms">cluster-density-ms<a class="headerlink" href="#cluster-density-ms" title="Permanent link">&para;</a></h3>
<p>Lightest version of this workload family, each iteration the following objects in each of the created namespaces:</p>
<ul>
<li>1 image stream.</li>
<li>4 deployments with two pod replicas (pause) mounting 4 secrets, 4 config maps, and 1 downward API volume each.</li>
<li>2 services, each one pointing to the TCP/8080 and TCP/8443 ports of the first and second deployment respectively.</li>
<li>1 edge route pointing to the to first service.</li>
<li>20 secrets containing a 2048-character random string.</li>
<li>10 config maps containing a 2048-character random string.</li>
</ul>
<h2 id="node-density-workloads">Node density workloads<a class="headerlink" href="#node-density-workloads" title="Permanent link">&para;</a></h2>
<p>The workloads of this family create a single namespace with a set of pods, deployments, and services depending on the workload.</p>
<h3 id="node-density">node-density<a class="headerlink" href="#node-density" title="Permanent link">&para;</a></h3>
<p>This workload is meant to fill with pause pods all the worker nodes from the cluster. It can be customized with the following flags. This workload is usually used to measure the Pod's ready latency KPI.</p>
<h3 id="node-density-cni">node-density-cni<a class="headerlink" href="#node-density-cni" title="Permanent link">&para;</a></h3>
<p>It creates two deployments, a client/curl and a server/nxing, and 1 service backed by the previous server pods. The client application has configured an startup probe that makes requests to the previous service every second with a timeout of 600s.</p>
<p>Note: This workload calculates the number of iterations to create from the number of nodes and desired pods per node.  In order to keep the test scalable and performant, chunks of 1000 iterations will by broken into separate namespaces, using the config variable <code>iterationsPerNamespace</code>.</p>
<h3 id="node-density-heavy">node-density-heavy<a class="headerlink" href="#node-density-heavy" title="Permanent link">&para;</a></h3>
<p>Creates two deployments, a postgresql database, and a simple client that performs periodic insert queries (configured through liveness and readiness probes) on the previous database and a service that is used by the client to reach the database.</p>
<p>Note: this workload calculates the number of iterations to create from the number of nodes and desired pods per node.  In order to keep the test scalable and performant, chunks of 1000 iterations will by broken into separate namespaces, using the config variable <code>iterationsPerNamespace</code>.</p>
<h3 id="node-scale">node-scale<a class="headerlink" href="#node-scale" title="Permanent link">&para;</a></h3>
<p>Leverages <a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-scalability/kubemark-guide.md">Kubemark</a> to create a number of hollow nodes and allow to run experiments on simulated clusters. The primary use case is scalability testing, as simulated clusters can be much bigger than the real ones. The objective is to expose problems with the master components (API server, controller manager or scheduler) that appear only on bigger clusters (e.g. small memory leaks).</p>
<h3 id="udn-density-l3-pods">udn-density-l3-pods<a class="headerlink" href="#udn-density-l3-pods" title="Permanent link">&para;</a></h3>
<p>For User-Defined Network (UDN) L3 segmentation testing. It creates two deployments, a client/curl and a server/nxing.</p>
<h3 id="anp-density-pods">anp-density-pods<a class="headerlink" href="#anp-density-pods" title="Permanent link">&para;</a></h3>
<p>For AdminNetworkPolicy testing. It creates three deployments in each namespace, three namespaces as a tenant, it will create 1 BaselineAdminNetworkPolicy, 1 NodeSelector AdminNetworkPolicy, 7 PodSelector AdminNetworkPolicy, N - CIDR Selector AdminNetworkPolicy.</p>
<h2 id="network-policy-workloads">Network Policy workloads<a class="headerlink" href="#network-policy-workloads" title="Permanent link">&para;</a></h2>
<p>Network policy scale testing tooling involved  2 components:
1. Template to include all network policy configuration options
2. Latency measurement through connection testing</p>
<p>A network policy defines the rules for ingress and egress traffic between pods in  local and remote namespaces. These remote namespace addresses can be configured using a combination of namespace and pod selectors, CIDRs, ports, and port ranges. Given that network policies offer a wide variety of configuration options, we developed a unified template that incorporates all these configuration parameters. Users can specify the desired count for each option.</p>
<div class="highlight"><pre><span></span><code><span class="go">spec:</span>
<span class="go">  podSelector:</span>
<span class="go">    matchExpressions:</span>
<span class="go">    - key: num</span>
<span class="go">      operator: In</span>
<span class="go">      values:</span>
<span class="go">      - &quot;1&quot;</span>
<span class="go">      - &quot;2&quot;</span>
<span class="go">  ingress:</span>
<span class="go">  - from:</span>
<span class="go">    - namespaceSelector:</span>
<span class="go">        matchExpressions:</span>
<span class="go">        - key: kubernetes.io/metadata.name</span>
<span class="go">          operator: In</span>
<span class="go">          values:</span>
<span class="go">          - network-policy-perf-13</span>
<span class="go">          - network-policy-perf-14</span>
<span class="go">      podSelector:</span>
<span class="go">       matchExpressions:</span>
<span class="go">       - key: num</span>
<span class="go">         operator: In</span>
<span class="go">         values:</span>
<span class="go">         - &quot;1&quot;</span>
<span class="go">         - &quot;2&quot;</span>
<span class="go">    ports:</span>
<span class="go">    - port: 8080</span>
<span class="go">      protocol: TCP</span>
</code></pre></div>
<h3 id="scale-testing-and-unique-acl-flows">Scale Testing and Unique ACL Flows<a class="headerlink" href="#scale-testing-and-unique-acl-flows" title="Permanent link">&para;</a></h3>
<p>In our scale tests, we aim to create between 10 to 100 network policies within a single namespace. The primary focus is on preventing duplicate configuration options, which ensures that each network policy generates unique Access Control List (ACL) flows. To achieve this, we carefully designed our templating approach based on the following considerations:</p>
<p><strong>Round-Robin Assignment:</strong> We use a round-robin strategy to distribute
1. remote namespaces among ingress and egress rules across kube burner job iterations
2. remote namespaces among ingress and egress rules in the same kube burner job iteration</p>
<p>This ensures that we don’t overuse the same remote namespaces in a single iteration or among multiple iterations. For instance, if namespace-1 uses namespace-2 and namespace-3 as its remote namespaces, then namespace-2 will start using namespace-4 and namespace-5 as remote namespaces in the next iteration.</p>
<p><strong>Unique Namespace and Pod Combinations:</strong> To avoid redundant flows, the templating system generates unique combinations of remote namespaces and pods for each network policy. Initially, we iterate through the list of remote namespaces, and once all remote namespaces are exhausted, we move on to iterate through the remote pods. This method ensures that every network policy within a namespace is assigned a distinct combination of remote namespaces and remote pods, avoiding duplicate pairs.</p>
<p><strong>Templating Logic</strong>
Our templating logic is implemented as follows:
<div class="highlight"><pre><span></span><code><span class="go">// Iterate over the list of namespaces to configure network policies.</span>
<span class="go">for namespace := namespaces {</span>

<span class="go">  // Each network policy uses a combination of a remote namespace and a remote pod to allow traffic.</span>
<span class="go">  for networkPolicy := networkPolicies {</span>

<span class="go">    /*</span>
<span class="go">    Iterate through the list of remote pods. Once all remote namespaces are exhausted,</span>
<span class="go">    continue iterating through the remote pods to ensure unique namespace/pod combinations.</span>
<span class="go">    */</span>
<span class="go">    for i, remotePod := range remotePods {</span>
<span class="go">        // Stop when we reach the maximum number of remote pods allowed.</span>
<span class="go">        if i == num_remote_pods {</span>
<span class="go">            break</span>
<span class="go">        }</span>

<span class="go">        // Iterate through the list of remote namespaces to pair with the remote pod.</span>
<span class="go">        for idx, remoteNamespace := range remoteNamespaces {</span>
<span class="go">            // Combine the remote namespace and pod into a unique pair for ACL configuration.</span>
<span class="go">            combine := fmt.Sprintf(&quot;%s:%s&quot;, remoteNamespace, remotePod)</span>

<span class="go">            // Stop iterating once we’ve exhausted the allowed number of remote namespaces.</span>
<span class="go">            if idx == num_remote_namespace {</span>
<span class="go">                break</span>
<span class="go">            }</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">  }</span>
<span class="go">}</span>
</code></pre></div></p>
<p><strong>CIDRs and Port Ranges</strong>
We apply the same round-robin and unique combination logic to CIDRs and port ranges, ensuring that these options are not reused in network policies within the same namespace.</p>
<p><strong>Connection Testing Support</strong>
kube-burner measures network policy latency through connection testing. Currently, all pods are configured to listen on port 8080. As a result, client pods will send requests to port 8080 during testing.</p>
<p>Note: Egress rules should not be enabled for network policy latency measurement connection testing.</p>
<h2 id="egressip-workloads">EgressIP workloads<a class="headerlink" href="#egressip-workloads" title="Permanent link">&para;</a></h2>
<p>This workload creates an egress IP for the client pods. SDN (OVN) will use egress IP for the traffic from client pods to external server instead of default node IP.</p>
<p>Each iteration creates the following objects in each of the created namespaces:</p>
<ul>
<li>1 deployment with the configured number of client pod replicas. Client pod runs the quay.io/cloud-bulldozer/eipvalidator app which periodically sends http request to the configured "EXT_SERVER_HOST" server at an "DELAY_BETWEEN_REQ_SEC" interval with a request timeout of "REQ_TIMEOUT_SEC" seconds. Client pod then validates if the body of the response has configured "EGRESS_IPS". Once the client pod starts running and after receiving first successful response with configured "EGRESS_IPS", it sets "eip_startup_latency_total" prometheus metric.</li>
<li>1 EgressIP object. EgressIP object is cluster scoped. EgressIP object will have number of egress IP addresses which user specified through "addresses-per-iteration" cli option. kube-burner generates these addresses for the egressIP object from the egress IP list provided by kube-burner-ocp. OVN applies egressIPs to the pods in the current job iteration because of "namespaceSelector" and "podSelector" fields in the egressIP object.</li>
</ul>
<p>Note: User has to manually create the external server or use the e2e-benchmarking(https://github.com/cloud-bulldozer/e2e-benchmarking/tree/master/workloads/kube-burner-ocp-wrapper#egressip) which deploys external server and runs the workload with required configuration.</p>
<p>Running 1 iteration with 1 egress IP address per iteration (or egressIP object).</p>
<div class="highlight"><pre><span></span><code><span class="go">kube-burner-ocp egressip --addresses-per-iteration=1 --iterations=1 --external-server-ip=10.0.34.43</span>
</code></pre></div>
<p>With the command above, each namespace has one pod with a dedicated egress IP. OVN will use this dedicated egress IP for the http requests from client pod's to 10.0.34.43.</p>
<h2 id="web-burner-workloads">Web-burner workloads<a class="headerlink" href="#web-burner-workloads" title="Permanent link">&para;</a></h2>
<p>This workload is meant to emulate some telco specific workloads. Before running <em>web-burner-node-density</em> or <em>web-burner-cluster-density</em> load the environment with <em>web-burner-init</em> first (without the garbage collection flag: <code>--gc=false</code>).</p>
<p>Pre-requisites:</p>
<ul>
<li>At least two worker nodes</li>
<li>At least one of the worker nodes must have the <code>node-role.kubernetes.io/worker-spk</code> label</li>
</ul>
<h3 id="web-burner-init">web-burner-init<a class="headerlink" href="#web-burner-init" title="Permanent link">&para;</a></h3>
<ul>
<li>35 (macvlan/sriov) networks for 35 lb namespace</li>
<li>35 lb-ns</li>
<li>1 frr config map, 4 emulated lb pods on each namespace</li>
<li>35 app-ns<ul>
<li>1 emulated lb pod on each namespace for bfd session</li>
</ul>
</li>
</ul>
<h3 id="web-burner-node-density">web-burner-node-density<a class="headerlink" href="#web-burner-node-density" title="Permanent link">&para;</a></h3>
<ul>
<li>35 app-ns</li>
<li>3 app pods and services on each namespace</li>
<li>35 normal-ns<ul>
<li>1 service with 60 normal pod endpoints on each namespace</li>
</ul>
</li>
</ul>
<h3 id="web-burner-cluster-density">web-burner-cluster-density<a class="headerlink" href="#web-burner-cluster-density" title="Permanent link">&para;</a></h3>
<ul>
<li>20 normal-ns<ul>
<li>30 configmaps, 38 secrets, 38 normal pods and services, 5 deployments with 2 replica pods on each namespace</li>
</ul>
</li>
<li>35 served-ns</li>
<li>3 app pods on each namespace</li>
<li>2 app-served-ns<ul>
<li>1 service(15 ports) with 84 pod endpoints, 1 service(15 ports) with 56 pod endpoints, 1 service(15 ports) with 25 pod endpoints</li>
<li>3 service(15 ports each) with 24 pod endpoints, 3 service(15 ports each) with 14 pod endpoints</li>
<li>6 service(15 ports each) with 12 pod endpoints, 6 service(15 ports each) with 10 pod endpoints, 6 service(15 ports each) with 9 pod endpoints</li>
<li>12 service(15 ports each) with 8 pod endpoints, 12 service(15 ports each) with 6 pod endpoints, 12 service(15 ports each) with 5 pod endpoints</li>
<li>29 service(15 ports each) with 4 pod endpoints, 29 service(15 ports each) with 6 pod endpoints</li>
</ul>
</li>
</ul>
<h2 id="core-rds-workloads">Core RDS workloads<a class="headerlink" href="#core-rds-workloads" title="Permanent link">&para;</a></h2>
<p>The telco core reference design specification (RDS) describes OpenShift Container Platform clusters running on commodity hardware that can support large scale telco applications including control plane and some centralized data plane functions. It captures the recommended, tested, and supported configurations to get reliable and repeatable performance for clusters running the telco core profile.</p>
<p>Pre-requisites:
 - A <strong>PerformanceProfile</strong> with isolated and reserved cores, 1G hugepages and and <code>topologyPolicy=single-numa-node</code>. Hugepages should be allocated in the first NUMA node (the one that would be used by DPDK deployments):
     <div class="highlight"><pre><span></span><code><span class="w"> </span><span class="nt">hugepages</span><span class="p">:</span>
<span class="w"> </span><span class="nt">defaultHugepagesSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1G</span>
<span class="w"> </span><span class="nt">pages</span><span class="p">:</span>
<span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">160</span>
<span class="w">   </span><span class="nt">node</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">   </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1G</span>
<span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class="w">   </span><span class="nt">node</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">   </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1G</span>
</code></pre></div>
 - <strong>MetalLB operator</strong> limiting speaker pods to specific nodes (approx. 10%, 12 in the case of 120 node iterations with the corresponding <strong><em>worker-metallb</em></strong> label):
     <div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metallb.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MetalLB</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metallb</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metallb-system</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">nodeSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">node-role.kubernetes.io/worker-metallb</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">  </span><span class="nt">speakerTolerations</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span>
<span class="w">    </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Exists&quot;</span>
<span class="w">    </span><span class="nt">effect</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NoExecute&quot;</span>
</code></pre></div>
 - <strong>SRIOV operator</strong> with its corresponding <em>SriovNetworkNodePolicy</em>
 - Some nodes (i.e.: 25% of them) with the <strong><em>worker-dpdk</em></strong> label to host the DPDK pods, i.e.:
     <div class="highlight"><pre><span></span><code>$ kubectl label node worker1 node-role.kubernetes.io/worker-dpdk=
</code></pre></div></p>
<p>Object count:
| Iterations / nodes / namespaces   | 1    | 120                                 |
| --------------------------------- | ---- | ----------------------------------- |
| configmaps                        | 30   | 3600                                |
| deployments_best_effort           | 25   | 3000                                |
| deployments_dpdk                  | 2    | 240 (assuming 24 worker-dpdk nodes) |
| endpoints (210x service)          | 4200 | 504000                              |
| endpoints lb (90 x service)       | 90   | 10800                               |
| networkPolicy                     | 3    | 360                                 |
| namespaces                        | 1    | 120                                 |
| pods_best_effort (2 x deployment) | 50   | 6000                                |
| pods_dpdk (1 x deployment)        | 2    | 240 (assuming 24 worker-dpdk nodes) |
| route                             | 2    | 240                                 |
| services                          | 20   | 2400                                |
| services (lb)                     | 1    | 120                                 |
| secrets                           | 42   | 5040                                |</p>
<p>Input parameters specific to the workload:
| Parameter           | Description                                                                                      | Default value |
| ------------------- | ------------------------------------------------------------------------------------------------ | ------------- |
| dpdk-cores          | Number of cores assigned for each DPDK pod (should fill all the isolated cores of one NUMA node) | 2             |
| performance-profile | Name of the performance profile implemented on the cluster                                       | default       |</p>
<h2 id="virt-workloads">Virt Workloads<a class="headerlink" href="#virt-workloads" title="Permanent link">&para;</a></h2>
<p>This workload family is a focused on Virtualization creating different objects across the cluster.</p>
<p>The different variants are:
- <a href="#virt-density">virt-density</a>
- <a href="#virt-density-udn">virt-udn-density</a>
- <a href="#virt-capacity-benchmark">virt-capacity-benchmark</a>.
- <a href="#virt-clone">virt-clone</a>
- <a href="#virt-ephemeral-restart">virt-ephemeral-restart</a>
- <a href="#virt-migration">virt-migration</a></p>
<h3 id="environment-requirements">Environment Requirements<a class="headerlink" href="#environment-requirements" title="Permanent link">&para;</a></h3>
<h4 id="virtctl">Virtctl<a class="headerlink" href="#virtctl" title="Permanent link">&para;</a></h4>
<p>The tests listed below verify that the <code>VirtualMachine</code> completed their boot using <code>virtctl ssh</code>.
Therefore, <code>virtctl</code> must be installed and available in the <code>PATH</code>.</p>
<ul>
<li><a href="#virt-capacity-benchmark">virt-capacity-benchmark</a>.</li>
<li><a href="#virt-clone">virt-clone</a></li>
<li><a href="#virt-ephemeral-restart">virt-ephemeral-restart</a></li>
<li><a href="#virt-migration">virt-migration</a></li>
</ul>
<p>See the <a href="#temporary-ssh-keys">Temporary SSH Keys</a> for details on the SSH keys used for the test</p>
<h4 id="temporary-ssh-keys">Temporary SSH Keys<a class="headerlink" href="#temporary-ssh-keys" title="Permanent link">&para;</a></h4>
<p>The test generated the SSH keys automatically.
By default, it stores the pair in a temporary directory.
Users may choose the store the key in a specified directory by setting <code>--ssh-key-path</code></p>
<h3 id="virt-density">Virt Density<a class="headerlink" href="#virt-density" title="Permanent link">&para;</a></h3>
<p>Similar to node-density, fills with VirtualMachines the worker nodes of the cluster (<strong>kubevirt/OpenShift Virtualization is required</strong> to run this workload). Meant to detect issues derived from spinning up high amounts VMs in a short amount of time and to track runningthe latencies of the different VM bootstrap stages.</p>
<h3 id="virt-density-udn">Virt Density Udn<a class="headerlink" href="#virt-density-udn" title="Permanent link">&para;</a></h3>
<p>Similar to udn-density-pods scenario. Creates VMs, one Nginx server and several clients (the number depends on the <code>vms-per-node</code> variable) reaching it, on the same UDN per iteration. Each UDN-namespace has the same number of VMs, the number of clients deployed per UDN is computed as following:
<code>Nb of client per UDN = (Nb of worker * vms-per-node / Nb of UDN) -1 //-1  because the server is always deployed.</code>
This scenario is meant to test how many UDNs can be deployed in parallel and how it scales. It requires a version of OCP higher than 4.18, otherwise, UDN feature is not available.</p>
<h3 id="virt-capacity-benchmark">Virt Capacity Benchmark<a class="headerlink" href="#virt-capacity-benchmark" title="Permanent link">&para;</a></h3>
<p>Test the capacity of Virtual Machines and Volumes supported by the cluster and a specific storage class.</p>
<h4 id="test-sequence">Test Sequence<a class="headerlink" href="#test-sequence" title="Permanent link">&para;</a></h4>
<p>The test runs a workload in a loop without deleting previously created resources. By default it will continue until a failure occurs.
Each loop is comprised of the following steps:
- Create VMs
- Resize the root and data volumes
- Restart the VMs
- Snapshot the VMs
- Migrate the VMs</p>
<h4 id="tested-storageclass">Tested StorageClass<a class="headerlink" href="#tested-storageclass" title="Permanent link">&para;</a></h4>
<p>By default, the test will search for the <code>StorageClass</code> to use:</p>
<ol>
<li>Use the default <code>StorageClass</code> for Virtualization annotated with <code>storageclass.kubevirt.io/is-default-virt-class</code></li>
<li>If does not exist, use general default <code>StorageClass</code> annotated with <code>storageclass.kubernetes.io/is-default-class</code></li>
<li>If does not exist, fail the test before starting</li>
</ol>
<p>To use a different one, use <code>--storage-class</code> to provide a different name.</p>
<p>In addition, multiple <code>StorageClasses</code> can be used by passing a comma separated list names.
The test will then choose a different <code>StorageClass</code> for each loop in round robin.</p>
<p>Please note that regardless to which <code>StorageClass</code> is used, it must:
- Support Volume Expansion: <code>allowVolumeExpansion: true</code>.
- Have a corresponding <code>VolumeSnapshotClass</code> using the same provisioner</p>
<h4 id="test-namespace">Test Namespace<a class="headerlink" href="#test-namespace" title="Permanent link">&para;</a></h4>
<p>All <code>VirtualMachines</code> are created in the same namespace.</p>
<p>By default, the namespace is <code>virt-capacity-benchmark</code>. Set it by passing <code>--namespace</code> (or <code>-n</code>)</p>
<h4 id="test-size-parameters">Test Size Parameters<a class="headerlink" href="#test-size-parameters" title="Permanent link">&para;</a></h4>
<p>Users may control the workload sizes by passing the following arguments:
- <code>--max-iterations</code> - Maximum number of iterations, or 0 (default) for infinite. In any case, the test will stop upon failure
- <code>--vms</code> - Number of VMs for each iteration (default 5)
- <code>--data-volume-count</code> - Number of data volumes for each VM (default 9)
- <code>--min-vol-size</code> - Set the minimal volume size supported by the storage class
- <code>--min-vol-inc-size</code> - Set the minimal volume size increment supported by the storage class</p>
<h4 id="skip-test-parts">Skip test parts<a class="headerlink" href="#skip-test-parts" title="Permanent link">&para;</a></h4>
<p>Some storage classes have limitations requiring the test to skip some parts:
- <code>--skip-resize-job</code> - Skip volume resize job. Use when e.g. <code>allowVolumeExpansion</code> is <code>false</code>
- <code>--skip-migration-job</code> - Skip the migration job. Use when e.g. <code>RWX</code> <code>accessMode</code> is not supported</p>
<h4 id="cleanup">Cleanup<a class="headerlink" href="#cleanup" title="Permanent link">&para;</a></h4>
<p>Since the test is expected to run until failure, it is designed to keep all allocated resources to allow investigating the failure.
To cleanup all allocated resources once the test is done set <code>--cleanup</code>.
Alternatively, run the test with only the <code>--cleanup-only</code> flag set to cleanup resources from past test runs</p>
<h3 id="virt-clone">Virt Clone<a class="headerlink" href="#virt-clone" title="Permanent link">&para;</a></h3>
<p>Test the capacity and performance of starting multiple virtual machines with a root disk as clones of a single volume. This test comes to mimic VDI sequence</p>
<h4 id="test-sequence_1">Test Sequence<a class="headerlink" href="#test-sequence_1" title="Permanent link">&para;</a></h4>
<p>The test runs the following sequence:
1. Create a <code>VirtualMachine</code> in namespace A
2. Stop the <code>VirtualMachine</code>
3. Create a <code>DataVolume</code> in namespace B using the rootdisk of the <code>VirtualMachine</code> as the source
4. If the <code>dataImportCronSourceFormat</code> field of the <code>StorageProfile</code> <code>status</code> is set to <code>snapshot</code>, or <code>--use-snapshot</code> is set to <code>true</code>, create a <code>VolumeSnapshot</code> of the DataVolume
5. Create a <code>DataSource</code>, setting the <code>source</code> field to either the <code>VolumeSnapshot</code> (if was created) or the <code>DataVolume</code>
6. Create <code>VirtualMachines</code> in namespace B based in the <code>DataSource</code></p>
<h4 id="tested-storageclass_1">Tested StorageClass<a class="headerlink" href="#tested-storageclass_1" title="Permanent link">&para;</a></h4>
<p>By default, the test will use the default <code>StorageClass</code>. To use a different one, use <code>--storage-class</code> to provide a different name.</p>
<p>If <code>--use-snapshot</code> is explicitly set to <code>true</code> a corresponding <code>VolumeSnapshotClass</code> using the same provisioner must exist.
Otherwise, the test will check the <code>StorageProfile</code> for the <code>StorageClass</code> and act accordingly.</p>
<h4 id="test-namespace_1">Test Namespace<a class="headerlink" href="#test-namespace_1" title="Permanent link">&para;</a></h4>
<p>The test creates <code>VirtualMachines</code> in two namespaces: <code>&lt;baseName&gt;-base</code> and <code>&lt;baseName&gt;-clones</code></p>
<p>By default, the <code>baseName</code> is <code>virt-clone</code>. Set it by passing <code>--namespace</code> (or <code>-n</code>)</p>
<h4 id="test-size-parameters_1">Test Size Parameters<a class="headerlink" href="#test-size-parameters_1" title="Permanent link">&para;</a></h4>
<p>Users may control the workload sizes by passing the following arguments:
- <code>--iteration</code> - Number of iterations to run in step 6. Default is 1
- <code>--iteration-clones</code> - Number of <code>VirtualMachines</code> to create in each iteration of step 6. Default is 10</p>
<h4 id="verification-of-cloned-virtualmachines-creation">Verification of cloned <code>VirtualMachines</code> creation<a class="headerlink" href="#verification-of-cloned-virtualmachines-creation" title="Permanent link">&para;</a></h4>
<p>By default, the test waits for all <code>VirtualMachines</code> created in an iteration to reach the <code>Ready</code> condition.
Users may configure the test to run differently.</p>
<ul>
<li><code>--verify-each-iteration</code> - Whether the test should verify the cloned <code>VirtualMachines</code> on each iteration. Default <code>true</code>. If set to <code>false</code> verification will be postpone to the end of the job</li>
<li><code>--job-iteration-delay</code> - Time in <code>Duration</code> for the test to wait between iterations. Default is <code>0</code></li>
<li><code>--verify-max-wait-time</code> - Time in <code>Duration</code> to wait for <code>VirtualMachines</code> to become ready either for each iteration or at the end.</li>
</ul>
<p>For example, to change the test to wait for a minute between iterations instead of the <code>VirtualMachines</code> to become <code>Ready</code> set: <code>--verify-each-iteration=false --job-iteration-delay=1m</code></p>
<h4 id="volume-access-mode">Volume Access Mode<a class="headerlink" href="#volume-access-mode" title="Permanent link">&para;</a></h4>
<p>By default, volumes are created with <code>ReadWriteMany</code> access mode as this is the recommended configuration for <code>VirtualMachines</code>.
If not supported, the access mode may be changes by setting <code>--access-mode</code>. The supported values are <code>RO</code>, <code>RWO</code> and <code>RWX</code>.</p>
<h3 id="virt-ephemeral-restart">Virt Ephemeral Restart<a class="headerlink" href="#virt-ephemeral-restart" title="Permanent link">&para;</a></h3>
<p>Test the performance of restarting ephemeral <code>VirtalMachine</code>s. Kubernetes native ephemeral volumes use local node storage. As a result, the cannot be used on large scale deployment.
Instead, a restart is implemented by stopping the <code>VirtualMachine</code>, deleting the <code>DataVolume</code> backing its root volume and starting it.</p>
<h4 id="test-sequence_2">Test Sequence<a class="headerlink" href="#test-sequence_2" title="Permanent link">&para;</a></h4>
<p>The test runs the following sequence:
1. Create a <code>DataVolume</code> using a container image as the source
2. If the <code>dataImportCronSourceFormat</code> field of the <code>StorageProfile</code> <code>status</code> is set to <code>snapshot</code>, or <code>--use-snapshot</code> is set to <code>true</code>, create a <code>VolumeSnapshot</code> of the DataVolume
3. Create a <code>DataSource</code>, setting the <code>source</code> field to either the <code>VolumeSnapshot</code> (if was created) or the <code>DataVolume</code>
4. Create <code>VirtualMachine</code>s based in the <code>DataSource</code>
5. Stop all <code>VirtualMachine</code>s
6. In batches, delete the <code>DataVolume</code> backing the root disk and start the <code>VirtualMachine</code>s</p>
<h4 id="tested-storageclass_2">Tested StorageClass<a class="headerlink" href="#tested-storageclass_2" title="Permanent link">&para;</a></h4>
<p>By default, the test will use the default <code>StorageClass</code>. To use a different one, use <code>--storage-class</code> to provide a different name.</p>
<p>If <code>--use-snapshot</code> is explicitly set to <code>true</code> a corresponding <code>VolumeSnapshotClass</code> using the same provisioner must exist.
Otherwise, the test will check the <code>StorageProfile</code> for the <code>StorageClass</code> and act accordingly.</p>
<h4 id="test-namespace_2">Test Namespace<a class="headerlink" href="#test-namespace_2" title="Permanent link">&para;</a></h4>
<p>All <code>VirtualMachines</code> are created in the same namespace.</p>
<p>By default, the namespace is <code>virt-ephemeral-restart</code>. Set it by passing <code>--namespace</code> (or <code>-n</code>)</p>
<h4 id="test-size-parameters_2">Test Size Parameters<a class="headerlink" href="#test-size-parameters_2" title="Permanent link">&para;</a></h4>
<p>Users may control the workload sizes by passing the following arguments:
- <code>--iteration-vms</code> - Number of <code>VirtualMachines</code> to batch in each group in step 6
- <code>--iteration</code> - Number of batches to run in step 6</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The total number of <code>VirtualMachines</code> created is <code>--iteration-vms</code> * <code>--iteration</code></p>
</div>
<h4 id="volume-access-mode_1">Volume Access Mode<a class="headerlink" href="#volume-access-mode_1" title="Permanent link">&para;</a></h4>
<p>By default, volumes are created with <code>ReadWriteMany</code> access mode as this is the recommended configuration for <code>VirtualMachines</code>.
If not supported, the access mode may be changes by setting <code>--access-mode</code>. The supported values are <code>RO</code>, <code>RWO</code> and <code>RWX</code>.</p>
<h3 id="virt-migration">Virt Migration<a class="headerlink" href="#virt-migration" title="Permanent link">&para;</a></h3>
<p>Test how the cluster and the storage backend handles mass migration of VMs</p>
<h4 id="test-sequence_3">Test Sequence<a class="headerlink" href="#test-sequence_3" title="Permanent link">&para;</a></h4>
<p>The test runs the following sequence:
1. Create <code>VirtualMachines</code> with a node affinity rule that ties them to a specific worker node
2. Remove the node affinity rule to allow them to migrate
3. Call <code>Migrate</code> on all <code>VirtualMachines</code></p>
<h4 id="tested-storageclass_3">Tested StorageClass<a class="headerlink" href="#tested-storageclass_3" title="Permanent link">&para;</a></h4>
<p>If not <code>--storage-class</code> is not set, the test will:</p>
<ol>
<li>Use the default <code>StorageClass</code> for Virtualization annotated with <code>storageclass.kubevirt.io/is-default-virt-class</code></li>
<li>If does not exist, use general default <code>StorageClass</code> annotated with <code>storageclass.kubernetes.io/is-default-class</code></li>
<li>If does not exist, fail the test before starting</li>
</ol>
<h4 id="test-size-parameters_3">Test Size Parameters<a class="headerlink" href="#test-size-parameters_3" title="Permanent link">&para;</a></h4>
<p>Users may control the workload sizes by passing the following arguments:
- <code>--iterations</code> - How many iterations to use when creating <code>VirtualMachines</code> in step 1
- <code>--iteration-vms</code> - How many <code>VirtualMachines</code> to create in each iteration in step 1
- <code>--data-volume-count</code> - Number of data volumes for each VM</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The total number of <code>VirtualMachines</code> created is <code>--iterations</code> * <code>--iteration-vms</code></p>
</div>
<h4 id="addition-virtualmachines-load">Addition <code>VirtualMachines</code> load<a class="headerlink" href="#addition-virtualmachines-load" title="Permanent link">&para;</a></h4>
<p>The test can create additional <code>VirtualMachines</code> that will not be migrated to simulate load on the other nodes as well.
By default, no additional <code>VirtualMachines</code> are created.</p>
<p>Set the following arguments to create load <code>VirtualMachines</code>:
- <code>--load-iterations</code> - Number of iterations to create load VMs
- <code>--load-per-iteration</code> - Number of VMs to create in each load VM iteration</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The total number of load <code>VirtualMachines</code> created is <code>--load-vms-iterations</code> * <code>--iteration-load-vms</code></p>
</div>
<h4 id="limiting-migration-requests-load">Limiting migration requests load<a class="headerlink" href="#limiting-migration-requests-load" title="Permanent link">&para;</a></h4>
<p>By default, the test will be limited to 20 concurrent migrate request calls.
Users can set a different value by passing <code>--migration-qps</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter limits the concurrent migration requests, not actual concurrent migrations</p>
</div>
<h4 id="initial-worker-node">Initial Worker Node<a class="headerlink" href="#initial-worker-node" title="Permanent link">&para;</a></h4>
<p>The worker node on which all VMs are scheduled and migrated from can be set by passing the <code>--worker-node</code> parameter.</p>
<p>If not set, the test will randomly choose one</p>
<h4 id="test-namespace_3">Test Namespace<a class="headerlink" href="#test-namespace_3" title="Permanent link">&para;</a></h4>
<p>All <code>VirtualMachines</code> are created in the same namespace.</p>
<p>By default, the namespace is <code>virt-migation</code>. Set it by passing <code>--namespace</code> (or <code>-n</code>)</p>
<h3 id="datavolume-clone">DataVolume Clone<a class="headerlink" href="#datavolume-clone" title="Permanent link">&para;</a></h3>
<p>Test the capacity and performance of creating multiple data volumes that are clones of a single data volume</p>
<h4 id="test-sequence_4">Test Sequence<a class="headerlink" href="#test-sequence_4" title="Permanent link">&para;</a></h4>
<p>The test runs the following sequence:
1. Create a <code>DataVolume</code> based on a container disk image
2. If the <code>dataImportCronSourceFormat</code> field of the <code>StorageProfile</code> <code>status</code> is set to <code>snapshot</code>, or <code>--use-snapshot</code> is set to <code>true</code>, create a <code>VolumeSnapshot</code> of the DataVolume
3. Create a <code>DataSource</code>, setting the <code>source</code> field to either the <code>VolumeSnapshot</code> (if was created) or the <code>DataVolume</code>
4. Create <code>DataVolumes</code> based on the <code>DataSource</code>. The creation process is divided into iterations</p>
<h4 id="tested-storageclass_4">Tested StorageClass<a class="headerlink" href="#tested-storageclass_4" title="Permanent link">&para;</a></h4>
<p>By default, the test will use the default <code>StorageClass</code>. To use a different one, use <code>--storage-class</code> to provide a different name.</p>
<p>If <code>--use-snapshot</code> is explicitly set to <code>true</code> a corresponding <code>VolumeSnapshotClass</code> using the same provisioner must exist.
Otherwise, the test will check the <code>StorageProfile</code> for the <code>StorageClass</code> and act accordingly.</p>
<h4 id="test-namespace_4">Test Namespace<a class="headerlink" href="#test-namespace_4" title="Permanent link">&para;</a></h4>
<p>All the resources are created in the same namespace.</p>
<p>By default, the namespace is <code>dv-clone</code>. Set it by passing <code>--namespace</code> (or <code>-n</code>)</p>
<h4 id="test-container-disk-image">Test Container Disk Image<a class="headerlink" href="#test-container-disk-image" title="Permanent link">&para;</a></h4>
<p>Users may set the container disk image used as a source to the base <code>DataVolume</code> using the <code>--container-disk</code> parameter.
When setting <code>--container-disk</code>, make sure that it can fit to the default Volume Size <code>1Gi</code> or set a new size by passing <code>--datavolume-size</code>.</p>
<p>If not passed, the test will use  <code>quay.io/yblum/tiny_image:latest</code> for the the container disk image.</p>
<h4 id="test-size-parameters_4">Test Size Parameters<a class="headerlink" href="#test-size-parameters_4" title="Permanent link">&para;</a></h4>
<p>Users may control the workload sizes by passing the following arguments:
- <code>--iteration</code> - Number of iterations to run in step 4
- <code>--iteration-clones</code> - Number of <code>DataVolumes</code> to create in each iteration of step 4</p>
<h4 id="volume-access-mode_2">Volume Access Mode<a class="headerlink" href="#volume-access-mode_2" title="Permanent link">&para;</a></h4>
<p>By default, volumes are created with <code>ReadWriteMany</code> access mode as this is the recommended configuration for <code>VirtualMachines</code>.
If not supported, the access mode may be changes by setting <code>--access-mode</code>. The supported values are <code>RO</code>, <code>RWO</code> and <code>RWX</code>.</p>
<h2 id="cudn-bgp-workload">CUDN BGP Workload<a class="headerlink" href="#cudn-bgp-workload" title="Permanent link">&para;</a></h2>
<p>This workload tests BGP route exchange import and export scenarios for the CUDNs.</p>
<p>Assumptions in this workload:
1. Kube burner must be running on a Linux host
2. Kube burner should be running on the host which is not used as a bastion host to deploy OCP cluster.
   a) Routes in the CUDN gateway router when we have the same host as the deployment host and kube burner host
<div class="highlight"><pre><span></span><code><span class="gp">sh-5.1# </span>ovn-nbctl<span class="w"> </span>lr-route-list<span class="w"> </span>GR_cluster_udn_cudn.0_e34-h14-000-r650.rdu2.scalelab.redhat.com
<span class="go">IPv4 Routes</span>
<span class="go">Route Table &lt;main&gt;:</span>
<span class="go">              20.0.2.0/24             192.168.0.1 dst-ip rtoe-GR_cluster_udn_cudn.0_e34-h14-000-r650.rdu2.scalelab.redhat.com</span>
<span class="go">                0.0.0.0/0               192.168.0.1 dst-ip rtoe-GR_cluster_udn_cudn.0_e34-h14-000-r650.rdu2.scalelab.redhat.com</span>
</code></pre></div>
   b) Routes in the CUDN gateway router when the deployment host and the kube burner host is different
<div class="highlight"><pre><span></span><code><span class="gp">sh-5.1# </span>ovn-nbctl<span class="w"> </span>lr-route-list<span class="w"> </span>GR_cluster_udn_cudn.0_e34-h14-000-r650.rdu2.scalelab.redhat.com
<span class="go">IPv4 Routes</span>
<span class="go">Route Table &lt;main&gt;:</span>
<span class="go">              20.0.2.0/24             192.168.0.145 dst-ip rtoe-GR_cluster_udn_cudn.0_e34-h14-000-r650.rdu2.scalelab.redhat.com</span>
<span class="go">                0.0.0.0/0               192.168.0.1 dst-ip rtoe-GR_cluster_udn_cudn.0_e34-h14-000-r650.rdu2.scalelab.redhat.com</span>
</code></pre></div>
   In case of same host i.e scenario a, ping reply will reach the kube burner even if the route "20.0.2.0/24" is not added, but using default route "0.0.0.0/0 192.168.0.1". Our purpose of the testing is to verify if the external route "20.0.2.0/24" is properly added or not in CUDN's gateway router. So we want the ping test to fail if this route is not correctly imported.</p>
<ol>
<li>An external FRR will be running on the same host where the kube burner is running.
   a) Here kube burner is the generator of the external routes. External FRR imports these routes into the OCP cluster through internal FRR and OVN.
   b) Also when external FRR routes receive the routes from the OCP cluster, kube burner validates them.</li>
<li>External FRR will be created by the user and configured to pair up with OCP cluster's OVN internal FRR routers</li>
<li>External FRR additionally configured to advertise the host routes i.e</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="go">vtysh</span>
<span class="go">configure terminal</span>
<span class="go">router bgp 64512</span>
<span class="go">redistribute static</span>
<span class="go">redistribute connected</span>
<span class="go">end</span>
<span class="go">write</span>
</code></pre></div>
<p>Unlike a UDN network, a CUDN network will be cluster scoped and can be used by multiple namespaces. However we restrict this to one namespace by default as our aim here is testing BGP route exchange.</p>
<p>This workload defines multiple jobs as per CUDN requirement. Some of the requirements:
1. Namespace with label "k8s.ovn.org/primary-user-defined-network" before the CUDN creation
2. OVN should create all the necessary resources for CUDN before a pod is created on it. Currently we don't have a mechanism to detect if the OVN has created all CUDN's resources. So we are using separate jobs for CUDN and pods with jobPause. Workload defines only one pod per CUDN.
3. RouteAdvertiments CRD selecting the CUDN. We use 1:1 RA:CUDN mapping.</p>
<p>As we want to measure BGP route exchange latency, this workload skips measurements for all the resources except RouteAdvertisements.</p>
<p>This workload has 2 BGP route exchange scenarios 1) route export scenaio 2) route import scenario
When a RouteAdvertisement is created, it advertises the selected CUDN's subnet to outside cluster. However, an external route is imported to the CUDN's gateway router only when it is advertised by the routeAdvertisment. Hence RouteAdvertisemnt for CUDN is mandatory for both export and import scenarios.</p>
<p>Sequent of events during workload execution
1. Job1 creates namespaces
2. Job2 creates CUDNs
3. Job3 creates Pods
4. When Job4 execution starts, Kube burner calls start measurement.
   RouteAdvertisment Latency measurement code then
   a. Maintains a list of CUDN subnets and the pod addresses.
   b. Starts export scenario
      i) Main thread subscribes (through routeCh channel) to kernel's netlink sockets for route monitoring
      ii) Starts export workers, which read from the subscribed routeCh channel
      iii) Registers an informer for notifying router advertisement resource creation events
5. Kube burner creates  RouteAdvertisments for CUDNs
   a. Kubernetes API notify the RouteAdvertisment resource to the listening kube burner
   b. OVN using the internal FRR advertises this route to the outside cluster (i.e to external FRR)
   c. External FRR adds the routes to the host. Kernel notifies the routes to the kube burner using netlink sockets
6. RouteAdvertisment Latency measurement code (watchers and export worker threads) then
   a. Records RouteAdvertisement name and creation timestamp when routeadvertisement resource is detected by the API
   b. For each route notified by the kernel, pings the corresponding CUDN's pod and records ping success timestamp
7. Kube burner calls stop measurements. RouteAdvertisment Latency measurement code then
   a. Waits for export scenario completion
   b. Starts import scenario
      i) Main thread creates interfaces, prepares IP addresses and pods to ping (which are needed for worker threads)
      ii) Starts import workers
      iii) Import workers add IP addresses on the interfaces
      iv) Kernel creates the linux route for the added IP address. Then external FRR router exports this to the cluster.
      v) OVN imports this route into the CUDN's gateway router.
      vi) Import worker pings the CUDN pod using the CUDN pod address as destination address and above added IP address as the source address.
      vii) Import worker records the ping success timestamp
   c. Waits for import scenario complettion
8. kube burner indexes all the latency measurements</p>
<h3 id="routeadvertisement-latency-metrics">RouteAdvertisement Latency Metrics<a class="headerlink" href="#routeadvertisement-latency-metrics" title="Permanent link">&para;</a></h3>
<p>RouteAdvetisements latency is calculated for both import and export scenarios, these latency metrics are in ms. It can be enabled with:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="err">measureme</span><span class="kc">nts</span><span class="p">:</span>
<span class="w">  </span><span class="mi">-</span><span class="w"> </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="err">podLa</span><span class="kc">ten</span><span class="err">cy</span>
</code></pre></div>
<p>The metrics collected are route advertisement latency timeseries (raLatencyMeasurement) and six documents holding a summary with different route latency quantiles of ping test and netlink route detection latency (raLatencyQuantilesMeasurement).</p>
<p>One document, such as the following, is indexed per each internal (through Routeadvertisment CRD) and external route (adding ip address on dummy interface) created by the workload:</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-04-15T08:41:10Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;metricName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;raLatencyMeasurement&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2c8a64a8-0409-4d17-8643-c28db8216821&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;jobName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;udn-bgp-route-advertisements&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;routeAdvertisementName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ra-0&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;ocpMajorVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4.19&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;ocpVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4.19.0-ec.3&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;scenario&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ExportRoutes&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;latency&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="mi">10031</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;minReadyLatency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10031</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxReadyLatency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10031</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;readyLatency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10031</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;netlinkRouteLatency&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="mi">10026</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;maxNetlinkRouteLatency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10026</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;minNetlinkRouteLatency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10026</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;p99NetlinkRouteLatency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10026</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-04-15T08:42:20.060393739Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;metricName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;raLatencyMeasurement&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2c8a64a8-0409-4d17-8643-c28db8216821&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;jobName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;udn-bgp-route-advertisements&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;routeAdvertisementName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;20.0.1.1/24&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;ocpMajorVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4.19&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;ocpVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4.19.0-ec.3&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;scenario&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ImportRoutes&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;latency&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="mi">13</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;minReadyLatency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxReadyLatency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;readyLatency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div>
<h2 id="olmv1-benchmark">OLMv1 Benchmark<a class="headerlink" href="#olmv1-benchmark" title="Permanent link">&para;</a></h2>
<p>To evaluate the performance of <code>Operator Lifecycle Manager v1</code> (OLMv1), this benchmark initiates the creation of a series of
<code>ClusterCatalog</code> and <code>ClusterExtension</code> custom resources. These resources serve as a representative workload to simulate realistic
catalog and operator deployment operations within the cluster. Each <code>ClusterExtension</code> internally triggers the resolution and
unpacking of an operator bundle through the configured catalog.</p>
<p>During the test execution, the system actively monitors and collects detailed resource usage metrics — specifically CPU and memory
consumption — for the pods running in both the <code>openshift-catalogd</code> and <code>openshift-operator-controller</code> namespaces. These
namespaces are critical components of the OLMv1 infrastructure, responsible for catalog resolution and operator deployment,
respectively.</p>
<p>In addition to standard resource metrics, the performance test is also capable of gathering pprof profiling data, which provides
in-depth runtime insights such as goroutine activity, heap allocations, and CPU profiles. This profiling capability is contingent on
the user explicitly enabling pprof endpoints within the OLMv1 components prior to test execution. Once enabled, the test can
automatically scrape and archive the profiling data for further analysis, facilitating root cause investigation and performance
optimization of the OLMv1 stack.</p>
<h3 id="environment-requirements_1">Environment Requirements<a class="headerlink" href="#environment-requirements_1" title="Permanent link">&para;</a></h3>
<p>OCP 4.18(OLMv1 GA) and above</p>
<h2 id="kueue-operator-workloads">Kueue Operator workloads<a class="headerlink" href="#kueue-operator-workloads" title="Permanent link">&para;</a></h2>
<p>The workloads of this family are used to exercise the Kueue Operator by creating pods or jobs depending on the workload. In order to run these jobs, Kueue Operator and Kueue CR should be installed on the target cluster.</p>
<h3 id="kueue-operator-jobs">kueue-operator-jobs<a class="headerlink" href="#kueue-operator-jobs" title="Permanent link">&para;</a></h3>
<p>This workload creates jobs in a single namespace that are handled by a single ClusterQueue with pre-defined CPU, memory and pod quotas. Key measurements are Kueue admission wait time, job start and completion latencies.</p>
<h3 id="kueue-operator-jobs-shared">kueue-operator-jobs-shared<a class="headerlink" href="#kueue-operator-jobs-shared" title="Permanent link">&para;</a></h3>
<p>This workload creates jobs in multiple namespaces that are handled by 10 shared ClusterQueues with pre-defined pod quotas. Key measurements are Kueue admission wait time, job start and completion latencies.</p>
<h3 id="kueue-operator-pods">kueue-operator-pods<a class="headerlink" href="#kueue-operator-pods" title="Permanent link">&para;</a></h3>
<p>This workload creates pods in a single namespace that are handled by a single ClusterQueue with pre-defined CPU, memory and pod quotas. Key measurements are Kueue admission wait time and pod ready latency.</p>
<h2 id="custom-workload-bring-your-own-workload">Custom Workload: Bring your own workload<a class="headerlink" href="#custom-workload-bring-your-own-workload" title="Permanent link">&para;</a></h2>
<p>To kickstart kube-burner-ocp with a custom workload, <code>init</code> becomes your go-to command. This command is equipped with flags that enable to seamlessly integrate and run your personalized workloads. Here's a breakdown of the flags accepted by the init command:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>kube-burner-ocp<span class="w"> </span>init<span class="w"> </span>--help
<span class="go">Runs custom workload</span>

<span class="go">Usage:</span>
<span class="go">  kube-burner-ocp init [flags]</span>

<span class="go">Flags:</span>
<span class="go">    --churn                            Enable churning (default true)</span>
<span class="go">    --churn-cycles int                 Churn cycles to execute</span>
<span class="go">    --churn-delay duration             Time to wait between each churn (default 2m0s)</span>
<span class="go">    --churn-deletion-strategy string   Churn deletion strategy to use (default &quot;default&quot;)</span>
<span class="go">    --churn-duration duration          Churn duration (default 5m0s)</span>
<span class="go">    --churn-percent int                Percentage of job iterations that kube-burner will churn each round (default 10)</span>
<span class="go">    -c, --config string                    Config file path or url</span>
<span class="go">    -h, --help                             help for init</span>
<span class="go">    --iterations int                   Job iterations. Mutually exclusive with &#39;--pods-per-node&#39; (default 1)</span>
<span class="go">    --iterations-per-namespace int     Iterations per namespace (default 1)</span>
<span class="go">    --namespaced-iterations            Namespaced iterations (default true)</span>
<span class="go">    --pods-per-node int                Pods per node. Mutually exclusive with &#39;--iterations&#39; (default 50)</span>
<span class="go">    --service-latency                  Enable service latency measurement</span>
</code></pre></div>
<p>Creating a custom workload for kube-burner-ocp is a seamless process, and you have the flexibility to craft it according to your specific needs. Below is a template to guide you through the customization of your workload:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span>
<span class="nt">indexers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">esServers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;{{.ES_SERVER}}&quot;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">insecureSkipVerify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">defaultIndex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="nv">.ES_INDEX</span><span class="p p-Indicator">}}</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">opensearch</span>
<span class="nt">global</span><span class="p">:</span>
<span class="w">  </span><span class="nt">gc</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="nv">.GC</span><span class="p p-Indicator">}}</span>
<span class="w">  </span><span class="nt">gcMetrics</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="nv">.GC_METRICS</span><span class="p p-Indicator">}}</span>
<span class="w">  </span><span class="nt">measurements</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;metric_name&gt;</span>
<span class="w">      </span><span class="nt">thresholds</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">&lt;threshold_key&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;threshold_value&gt;</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;job_name&gt;</span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;namespace_name&gt;</span>
<span class="w">    </span><span class="nt">jobIterations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;number of iterations&gt;</span>
<span class="w">    </span><span class="nt">qps</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="nv">.QPS</span><span class="p p-Indicator">}}</span><span class="w">     </span><span class="c1"># Both QPS and BURST can be specified through the CLI</span>
<span class="w">    </span><span class="nt">burst</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="nv">.BURST</span><span class="p p-Indicator">}}</span>
<span class="w">    </span><span class="nt">namespacedIterations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;bool&gt;</span>
<span class="w">    </span><span class="nt">podWait</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;bool&gt;</span>
<span class="w">    </span><span class="nt">waitWhenFinished</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;bool&gt;</span>
<span class="w">    </span><span class="nt">preLoadImages</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;bool&gt;</span>
<span class="w">    </span><span class="nt">preLoadPeriod</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;preLoadPeriod_in_seconds&gt;</span>
<span class="w">    </span><span class="nt">namespaceLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;namespaceLabels_key&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;namespaceLabels_value&gt;</span>
<span class="w">    </span><span class="nt">objects</span><span class="p">:</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">objectTemplate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;template_config&gt;</span>
<span class="w">        </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;replica_int&gt;</span>
<span class="w">        </span><span class="nt">inputVars</span><span class="p">:</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">&lt;inputVar1&gt;:&lt;inputVar1_value&gt;</span>
</code></pre></div>
<p>You can start from scratch or explore pre-built workloads in the /config folder, offering a variety of examples used by kube-burner-ocp. Dive into the details of each section in the template to tailor the workload precisely to your requirements. Experiment, iterate, and discover the optimal configuration for your workload to seamlessly integrate with kube-burner-ocp.</p>
<h2 id="index">Index<a class="headerlink" href="#index" title="Permanent link">&para;</a></h2>
<p>Just like the regular kube-burner, <code>kube-burner-ocp</code> also has an indexing functionality which is exposed as <code>index</code> subcommand.</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>kube-burner-ocp<span class="w"> </span>index<span class="w"> </span>--help
<span class="go">If no other indexer is specified, local indexer is used by default</span>

<span class="go">Usage:</span>
<span class="go">  kube-burner-ocp index [flags]</span>

<span class="go">Flags:</span>
<span class="go">  -m, --metrics-profile string     Metrics profile file (default &quot;metrics.yml&quot;)</span>
<span class="go">      --metrics-directory string   Directory to dump the metrics files in, when using default local indexing (default &quot;collected-metrics&quot;)</span>
<span class="go">  -s, --step duration              Prometheus step size (default 30s)</span>
<span class="go">      --start int                  Epoch start time</span>
<span class="go">      --end int                    Epoch end time</span>
<span class="go">  -j, --job-name string            Indexing job name (default &quot;kube-burner-ocp-indexing&quot;)</span>
<span class="go">      --user-metadata string       User provided metadata file, in YAML format</span>
<span class="go">  -h, --help                       help for index</span>
</code></pre></div>
<h2 id="metrics-profile-type">Metrics-profile type<a class="headerlink" href="#metrics-profile-type" title="Permanent link">&para;</a></h2>
<p>By specifying <code>--profile-type</code>, kube-burner can use two different metrics profiles when scraping metrics from prometheus. By default is configured with <code>both</code>, meaning that it will use the regular metrics profiles bound to the workload in question and the reporting metrics profile.</p>
<p>When using the regular profiles (<a href="https://github.com/kube-burner/kube-burner-ocp/blob/master/cmd/config/metrics-aggregated.yml">metrics-aggregated</a> or <a href="https://github.com/kube-burner/kube-burner-ocp/blob/master/cmd/config/metrics.yml">metrics</a>), kube-burner scrapes and indexes metrics timeseries.</p>
<p>The reporting profile is very useful to reduce the number of documents sent to the configured indexer. Thanks to the combination of aggregations and instant queries for prometheus metrics, and 4 summaries for latency measurements, only a few documents will be indexed per benchmark. This flag makes possible to specify one or both of these profiles indistinctly.</p>
<h2 id="customizing-workloads">Customizing workloads<a class="headerlink" href="#customizing-workloads" title="Permanent link">&para;</a></h2>
<p>It is possible to customize any of the above workload configurations by extracting, updating, and finally running it:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>kube-burner-ocp<span class="w"> </span>node-density<span class="w"> </span>--extract
<span class="gp">$ </span>ls
<span class="go">alerts.yml  metrics.yml  node-density.yml  pod.yml  metrics-report.yml</span>
<span class="gp">$ </span>vi<span class="w"> </span>node-density.yml<span class="w">                               </span><span class="c1"># Perform modifications accordingly</span>
<span class="gp">$ </span>kube-burner-ocp<span class="w"> </span>node-density<span class="w"> </span>--pods-per-node<span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="c1"># Run workload</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["navigation.instant", "navigation.tracking", "navigation.indexes", "navigation.top", "navigation.footer", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"limit": 3, "provider": "mike"}}</script>
    
    
      <script src="assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>